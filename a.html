<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Catálogo de Productos - Tienda de Ropa</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.10/dist/sweetalert2.min.css" rel="stylesheet">
  <style id="app-style">
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background-color: #f8f9fa;
      color: #212529;
    }
    
    .navbar-brand {
      font-weight: 600;
      letter-spacing: -0.5px;
    }
    
    .card {
      border-radius: 10px;
      border: none;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    }
    
    .card-header {
      background-color: #fff;
      border-bottom: 1px solid #f0f0f0;
      padding-top: 20px;
      padding-bottom: 20px;
    }
    
    .table th {
      font-weight: 600;
      color: #495057;
      border-top: none;
    }
    
    .btn-primary {
      background-color: #4361ee;
      border-color: #4361ee;
    }
    
    .btn-primary:hover {
      background-color: #3a56d4;
      border-color: #3a56d4;
    }
    
    .btn-outline-primary {
      color: #4361ee;
      border-color: #4361ee;
    }
    
    .btn-outline-primary:hover {
      background-color: #4361ee;
      border-color: #4361ee;
    }
    
    .badge {
      font-weight: 500;
      padding: 6px 10px;
    }
    
    .modal-content {
      border-radius: 10px;
      border: none;
    }
    
    .modal-header {
      border-bottom: 1px solid #f0f0f0;
    }
    
    .modal-footer {
      border-top: 1px solid #f0f0f0;
    }
    
    .form-control:focus, .form-select:focus {
      border-color: #4361ee;
      box-shadow: 0 0 0 0.25rem rgba(67, 97, 238, 0.25);
    }
    
    .form-label {
      font-weight: 500;
      margin-bottom: 0.5rem;
      color: #495057;
    }
    
    .spinner-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(255, 255, 255, 0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }
    
    .empty-state {
      text-align: center;
      padding: 40px 0;
    }
    
    .empty-state i {
      font-size: 4rem;
      color: #dee2e6;
      margin-bottom: 20px;
    }
    
    .empty-state h4 {
      color: #6c757d;
      font-weight: 500;
    }
    
    .empty-state p {
      color: #adb5bd;
      max-width: 400px;
      margin: 0 auto;
    }
    
    .action-buttons .btn {
      padding: 0.25rem 0.5rem;
      font-size: 0.875rem;
    }
    
    .product-table th, .product-table td {
      vertical-align: middle;
    }
    
    .price-column {
      min-width: 100px;
    }
    
    .filter-card {
      margin-bottom: 20px;
    }
    
    .pagination {
      margin-top: 20px;
    }
    
    .was-validated .form-control:invalid,
    .form-control.is-invalid {
      border-color: #dc3545;
      padding-right: calc(1.5em + 0.75rem);
      background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12' width='12' height='12' fill='none' stroke='%23dc3545'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3e%3ccircle cx='6' cy='8.2' r='.6' fill='%23dc3545' stroke='none'/%3e%3c/svg%3e");
      background-repeat: no-repeat;
      background-position: right calc(0.375em + 0.1875rem) center;
      background-size: calc(0.75em + 0.375rem) calc(0.75em + 0.375rem);
    }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-light bg-white border-bottom">
    <div class="container">
      <a class="navbar-brand" href="javascript:void(0)">
        <i class="fas fa-tshirt me-2"></i>
        Mi Tienda de Ropa
      </a>
      <!-- Add GitHub repository button to navbar -->
      <div class="ms-auto">
        <button type="button" class="btn btn-success" id="createGithubRepoBtn">
          <i class="fab fa-github me-1"></i> Crear Repositorio GitHub
        </button>
      </div>
    </div>
  </nav>

  <!-- Add GitHub status section below navbar -->
  <div class="container mt-3 mb-0">
    <div class="row">
      <div class="col-12">
        <div class="alert alert-info d-flex align-items-center" role="alert">
          <i class="fab fa-github me-2 fs-5"></i>
          <div>
            <span id="githubStatusText">Estado del repositorio: No conectado</span>
            <a href="#" class="ms-2 d-none" id="githubRepoLink" target="_blank">Ver en GitHub</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="container my-4">
    <div class="row">
      <div class="col-12">
        <div class="card filter-card">
          <div class="card-body">
            <h5 class="card-title mb-3">Filtros</h5>
            <div class="row g-3">
              <div class="col-md-4">
                <label for="colorFilter" class="form-label">Color</label>
                <input type="text" class="form-control" id="colorFilter" placeholder="Filtrar por color">
              </div>
              <div class="col-md-4">
                <label for="sizeFilter" class="form-label">Talla</label>
                <input type="text" class="form-control" id="sizeFilter" placeholder="Filtrar por talla">
              </div>
              <div class="col-md-4">
                <label for="priceFilter" class="form-label">Precio máximo</label>
                <input type="number" class="form-control" id="priceFilter" placeholder="Precio máximo">
              </div>
            </div>
            <div class="d-flex justify-content-end mt-3">
              <button type="button" class="btn btn-outline-secondary me-2" id="clearFilters">
                <i class="fas fa-times me-1"></i> Limpiar filtros
              </button>
              <button type="button" class="btn btn-primary" id="applyFilters">
                <i class="fas fa-filter me-1"></i> Aplicar filtros
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-12">
        <div class="card">
          <div class="card-header d-flex justify-content-between align-items-center">
            <h5 class="mb-0">Catálogo de Productos</h5>
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#productModal" id="createProductBtn">
              <i class="fas fa-plus me-1"></i> Crear Producto
            </button>
          </div>
          <div class="card-body">
            <div class="table-responsive">
              <table class="table product-table" id="productTable">
                <thead>
                  <tr>
                    <th scope="col">ID</th>
                    <th scope="col">Talla</th>
                    <th scope="col">Color</th>
                    <th scope="col" class="price-column">Precio</th>
                    <th scope="col">Descripción</th>
                    <th scope="col" class="text-center">Acciones</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- Los productos se cargarán dinámicamente aquí -->
                </tbody>
              </table>
            </div>
            
            <!-- Estado vacío (se mostrará cuando no haya productos) -->
            <div class="empty-state d-none" id="emptyState">
              <i class="fas fa-box-open"></i>
              <h4>No hay productos en el catálogo</h4>
              <p>Comienza añadiendo productos al catálogo con el botón "Crear Producto".</p>
            </div>
            
            <!-- Paginación -->
            <nav aria-label="Paginación de productos" class="d-flex justify-content-center">
              <ul class="pagination" id="pagination">
                <li class="page-item disabled">
                  <a class="page-link" href="javascript:void(0)" tabindex="-1" aria-disabled="true">Anterior</a>
                </li>
                <li class="page-item active"><a class="page-link" href="javascript:void(0)">1</a></li>
                <li class="page-item"><a class="page-link" href="javascript:void(0)">2</a></li>
                <li class="page-item"><a class="page-link" href="javascript:void(0)">3</a></li>
                <li class="page-item">
                  <a class="page-link" href="javascript:void(0)">Siguiente</a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Producto (Crear/Editar) -->
  <div class="modal fade" id="productModal" tabindex="-1" aria-labelledby="productModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="productModalLabel">Crear Producto</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <form id="productForm" class="needs-validation" novalidate>
            <input type="hidden" id="productId" value="">
            
            <div class="mb-3">
              <label for="productSize" class="form-label">Talla</label>
              <input type="text" class="form-control" id="productSize" required>
              <div class="invalid-feedback">
                Por favor ingresa la talla del producto.
              </div>
            </div>
            
            <div class="mb-3">
              <label for="productColor" class="form-label">Color</label>
              <input type="text" class="form-control" id="productColor" required>
              <div class="invalid-feedback">
                Por favor ingresa el color del producto.
              </div>
            </div>
            
            <div class="mb-3">
              <label for="productPrice" class="form-label">Precio</label>
              <div class="input-group">
                <span class="input-group-text">€</span>
                <input type="number" class="form-control" id="productPrice" min="0.01" step="0.01" required>
                <div class="invalid-feedback">
                  Por favor ingresa un precio válido (mayor que 0).
                </div>
              </div>
            </div>
            
            <div class="mb-3">
              <label for="productDescription" class="form-label">Descripción</label>
              <textarea class="form-control" id="productDescription" rows="3" required></textarea>
              <div class="invalid-feedback">
                Por favor ingresa una descripción para el producto.
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="button" class="btn btn-primary" id="saveProductBtn">Guardar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Confirmación de Eliminación -->
  <div class="modal fade" id="deleteConfirmModal" tabindex="-1" aria-labelledby="deleteConfirmModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="deleteConfirmModalLabel">Confirmar eliminación</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <p>¿Estás seguro de que deseas eliminar este producto? Esta acción no se puede deshacer.</p>
          <input type="hidden" id="deleteProductId" value="">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="button" class="btn btn-danger" id="confirmDeleteBtn">Eliminar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Overlay de carga -->
  <div class="spinner-overlay d-none" id="loadingOverlay">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
  </div>

  <!-- Add footer before closing body tag -->
  <footer class="bg-light py-3 mt-5 border-top">
    <div class="container text-center">
      <p class="text-muted mb-0">
        <small>© 2023 Mi Tienda de Ropa. Esta versión de la interfaz de administración admite integración con GitHub para facilitar despliegues y gestión de repositorios.</small>
      </p>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.10/dist/sweetalert2.all.min.js"></script>
  <script id="app-script">
    // Estado de la aplicación
    const appState = {
      products: [],
      filters: {
        color: '',
        size: '',
        maxPrice: ''
      },
      currentPage: 1,
      itemsPerPage: 5,
      isEditing: false,
      // Add GitHub repository state
      githubRepo: {
        connected: false,
        url: '',
        name: ''
      }
    };

    // Referencias a elementos DOM
    const elements = {
      productTable: document.getElementById('productTable'),
      productTableBody: document.querySelector('#productTable tbody'),
      emptyState: document.getElementById('emptyState'),
      productForm: document.getElementById('productForm'),
      productModal: document.getElementById('productModal'),
      productModalLabel: document.getElementById('productModalLabel'),
      loadingOverlay: document.getElementById('loadingOverlay'),
      saveProductBtn: document.getElementById('saveProductBtn'),
      createProductBtn: document.getElementById('createProductBtn'),
      confirmDeleteBtn: document.getElementById('confirmDeleteBtn'),
      deleteConfirmModal: document.getElementById('deleteConfirmModal'),
      colorFilter: document.getElementById('colorFilter'),
      sizeFilter: document.getElementById('sizeFilter'),
      priceFilter: document.getElementById('priceFilter'),
      applyFiltersBtn: document.getElementById('applyFilters'),
      clearFiltersBtn: document.getElementById('clearFilters'),
      pagination: document.getElementById('pagination'),
      // Add GitHub elements
      createGithubRepoBtn: document.getElementById('createGithubRepoBtn'),
      githubStatusText: document.getElementById('githubStatusText'),
      githubRepoLink: document.getElementById('githubRepoLink')
    };

    // Modal de Bootstrap
    const productModal = new bootstrap.Modal(document.getElementById('productModal'));
    const deleteModal = new bootstrap.Modal(document.getElementById('deleteConfirmModal'));

    // Cargar filtros desde LocalStorage
    function loadFiltersFromLocalStorage() {
      const savedFilters = localStorage.getItem('productFilters');
      if (savedFilters) {
        try {
          const parsedFilters = JSON.parse(savedFilters);
          appState.filters = parsedFilters;
          
          // Actualizar la UI con los filtros guardados
          elements.colorFilter.value = parsedFilters.color || '';
          elements.sizeFilter.value = parsedFilters.size || '';
          elements.priceFilter.value = parsedFilters.maxPrice || '';
        } catch (e) {
          console.error('Error parsing filters from localStorage:', e);
        }
      }
    }

    // Guardar filtros en LocalStorage
    function saveFiltersToLocalStorage() {
      localStorage.setItem('productFilters', JSON.stringify(appState.filters));
    }

    // Mostrar overlay de carga
    function showLoading() {
      elements.loadingOverlay.classList.remove('d-none');
    }

    // Ocultar overlay de carga
    function hideLoading() {
      elements.loadingOverlay.classList.add('d-none');
    }

    // Mostrar notificación
    function showNotification(title, message, type = 'success') {
      Swal.fire({
        title: title,
        text: message,
        icon: type,
        toast: true,
        position: 'top-end',
        showConfirmButton: false,
        timer: 3000,
        timerProgressBar: true
      });
    }

    // Simular una petición API (Loop)
    async function simulateApiRequest(endpoint, method = 'GET', data = null) {
      showLoading();
      
      // Simulamos una pequeña demora para mostrar el estado de carga
      await new Promise(resolve => setTimeout(resolve, 800));
      
      hideLoading();
      
      return {
        success: true,
        message: "Esta es una versión prototipo. En la versión final, se conectará a una API real."
      };
    }

    // Cargar productos (simular petición a la API)
    async function loadProducts() {
      showLoading();
      
      try {
        // Simulamos datos de productos para el prototipo
        appState.products = [
          { id: 1, size: 'S', color: 'Rojo', price: 29.99, description: 'Camiseta básica de algodón en color rojo' },
          { id: 2, size: 'M', color: 'Azul', price: 35.50, description: 'Pantalón vaquero elástico azul' },
          { id: 3, size: 'L', color: 'Negro', price: 49.99, description: 'Chaqueta ligera de entretiempo en color negro' },
          { id: 4, size: 'XL', color: 'Blanco', price: 22.95, description: 'Camiseta oversize de manga larga en blanco' },
          { id: 5, size: 'M', color: 'Verde', price: 39.95, description: 'Sudadera con capucha verde' },
          { id: 6, size: 'S', color: 'Amarillo', price: 19.95, description: 'Top de tirantes amarillo con detalle en la espalda' },
          { id: 7, size: 'L', color: 'Gris', price: 59.99, description: 'Vestido casual en color gris para ocasiones especiales' }
        ];
        
        // Filtramos los productos según los filtros aplicados
        const filteredProducts = filterProducts();
        
        // Renderizamos los productos
        renderProducts(filteredProducts);
        
        // Simulamos una pequeña demora para mostrar el estado de carga
        await new Promise(resolve => setTimeout(resolve, 500));
      } catch (error) {
        console.error('Error loading products:', error);
        showNotification('Error', 'No se pudieron cargar los productos.', 'error');
      } finally {
        hideLoading();
      }
    }

    // Filtrar productos según los criterios establecidos
    function filterProducts() {
      return appState.products.filter(product => {
        // Filtrar por color
        if (appState.filters.color && !product.color.toLowerCase().includes(appState.filters.color.toLowerCase())) {
          return false;
        }
        
        // Filtrar por talla
        if (appState.filters.size && !product.size.toLowerCase().includes(appState.filters.size.toLowerCase())) {
          return false;
        }
        
        // Filtrar por precio máximo
        if (appState.filters.maxPrice && product.price > parseFloat(appState.filters.maxPrice)) {
          return false;
        }
        
        return true;
      });
    }

    // Renderizar productos en la tabla
    function renderProducts(products) {
      elements.productTableBody.innerHTML = '';
      
      if (products.length === 0) {
        elements.emptyState.classList.remove('d-none');
        elements.productTable.classList.add('d-none');
        elements.pagination.classList.add('d-none');
        return;
      }
      
      elements.emptyState.classList.add('d-none');
      elements.productTable.classList.remove('d-none');
      elements.pagination.classList.remove('d-none');
      
      // Calcular paginación
      const startIndex = (appState.currentPage - 1) * appState.itemsPerPage;
      const endIndex = startIndex + appState.itemsPerPage;
      const paginatedProducts = products.slice(startIndex, endIndex);
      
      // Crear filas de la tabla
      paginatedProducts.forEach(product => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${product.id}</td>
          <td>${product.size}</td>
          <td>
            <span class="badge bg-light text-dark">${product.color}</span>
          </td>
          <td>${product.price.toFixed(2)} €</td>
          <td>${product.description}</td>
          <td class="text-center">
            <div class="action-buttons">
              <button type="button" class="btn btn-sm btn-outline-primary me-1 edit-product-btn" data-id="${product.id}">
                <i class="fas fa-edit"></i>
              </button>
              <button type="button" class="btn btn-sm btn-outline-danger delete-product-btn" data-id="${product.id}">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </td>
        `;
        
        elements.productTableBody.appendChild(row);
      });
      
      // Añadir listeners a los botones de editar y eliminar
      document.querySelectorAll('.edit-product-btn').forEach(btn => {
        btn.addEventListener('click', () => openEditProductModal(parseInt(btn.dataset.id)));
      });
      
      document.querySelectorAll('.delete-product-btn').forEach(btn => {
        btn.addEventListener('click', () => openDeleteConfirmModal(parseInt(btn.dataset.id)));
      });
      
      // Actualizar paginación
      updatePagination(products.length);
    }

    // Actualizar controles de paginación
    function updatePagination(totalItems) {
      const totalPages = Math.ceil(totalItems / appState.itemsPerPage);
      let paginationHTML = '';
      
      // Botón Anterior
      paginationHTML += `
        <li class="page-item ${appState.currentPage === 1 ? 'disabled' : ''}">
          <a class="page-link" href="javascript:void(0)" data-page="${appState.currentPage - 1}" aria-disabled="${appState.currentPage === 1}">Anterior</a>
        </li>
      `;
      
      // Números de página
      for (let i = 1; i <= totalPages; i++) {
        paginationHTML += `
          <li class="page-item ${appState.currentPage === i ? 'active' : ''}">
            <a class="page-link" href="javascript:void(0)" data-page="${i}">${i}</a>
          </li>
        `;
      }
      
      // Botón Siguiente
      paginationHTML += `
        <li class="page-item ${appState.currentPage === totalPages ? 'disabled' : ''}">
          <a class="page-link" href="javascript:void(0)" data-page="${appState.currentPage + 1}" aria-disabled="${appState.currentPage === totalPages}">Siguiente</a>
        </li>
      `;
      
      elements.pagination.innerHTML = paginationHTML;
      
      // Añadir eventos a los links de paginación
      document.querySelectorAll('.page-link').forEach(link => {
        link.addEventListener('click', (e) => {
          if (!link.parentElement.classList.contains('disabled')) {
            appState.currentPage = parseInt(link.dataset.page);
            const filteredProducts = filterProducts();
            renderProducts(filteredProducts);
          }
        });
      });
    }

    // Abrir modal para crear un nuevo producto
    function openCreateProductModal() {
      appState.isEditing = false;
      elements.productModalLabel.textContent = 'Crear Producto';
      elements.productForm.reset();
      document.getElementById('productId').value = '';
      elements.productForm.classList.remove('was-validated');
      productModal.show();
    }

    // Abrir modal para editar un producto existente
    function openEditProductModal(productId) {
      appState.isEditing = true;
      elements.productModalLabel.textContent = 'Editar Producto';
      
      const product = appState.products.find(p => p.id === productId);
      if (product) {
        document.getElementById('productId').value = product.id;
        document.getElementById('productSize').value = product.size;
        document.getElementById('productColor').value = product.color;
        document.getElementById('productPrice').value = product.price;
        document.getElementById('productDescription').value = product.description;
      }
      
      elements.productForm.classList.remove('was-validated');
      productModal.show();
    }

    // Abrir modal de confirmación para eliminar un producto
    function openDeleteConfirmModal(productId) {
      document.getElementById('deleteProductId').value = productId;
      deleteModal.show();
    }

    // Guardar producto (crear nuevo o actualizar existente)
    async function saveProduct() {
      const form = elements.productForm;
      
      // Validar formulario
      if (!form.checkValidity()) {
        form.classList.add('was-validated');
        return;
      }
      
      const productId = document.getElementById('productId').value;
      const productData = {
        size: document.getElementById('productSize').value,
        color: document.getElementById('productColor').value,
        price: parseFloat(document.getElementById('productPrice').value),
        description: document.getElementById('productDescription').value
      };
      
      try {
        if (appState.isEditing) {
          // Actualizar producto existente
          await simulateApiRequest(`/api/products/${productId}`, 'PUT', productData);
          
          // Actualizar en el estado local
          const index = appState.products.findIndex(p => p.id === parseInt(productId));
          if (index !== -1) {
            appState.products[index] = { ...appState.products[index], ...productData };
          }
          
          showNotification('¡Éxito!', 'Producto actualizado correctamente.');
        } else {
          // Crear nuevo producto
          await simulateApiRequest('/api/products', 'POST', productData);
          
          // Añadir al estado local con un ID simulado
          const newId = appState.products.length > 0 
            ? Math.max(...appState.products.map(p => p.id)) + 1 
            : 1;
          
          appState.products.push({
            id: newId,
            ...productData
          });
          
          showNotification('¡Éxito!', 'Producto creado correctamente.');
        }
        
        // Cerrar modal y recargar lista
        productModal.hide();
        const filteredProducts = filterProducts();
        renderProducts(filteredProducts);
        
      } catch (error) {
        console.error('Error saving product:', error);
        showNotification('Error', 'No se pudo guardar el producto.', 'error');
      }
    }

    // Eliminar producto
    async function deleteProduct() {
      const productId = parseInt(document.getElementById('deleteProductId').value);
      
      try {
        await simulateApiRequest(`/api/products/${productId}`, 'DELETE');
        
        // Eliminar del estado local
        appState.products = appState.products.filter(p => p.id !== productId);
        
        // Cerrar modal y recargar lista
        deleteModal.hide();
        const filteredProducts = filterProducts();
        renderProducts(filteredProducts);
        
        showNotification('¡Éxito!', 'Producto eliminado correctamente.');
        
      } catch (error) {
        console.error('Error deleting product:', error);
        showNotification('Error', 'No se pudo eliminar el producto.', 'error');
      }
    }

    // Aplicar filtros
    function applyFilters() {
      appState.filters = {
        color: elements.colorFilter.value.trim(),
        size: elements.sizeFilter.value.trim(),
        maxPrice: elements.priceFilter.value.trim()
      };
      
      // Guardar filtros en LocalStorage
      saveFiltersToLocalStorage();
      
      // Resetear a la primera página
      appState.currentPage = 1;
      
      // Aplicar filtros y renderizar
      const filteredProducts = filterProducts();
      renderProducts(filteredProducts);
    }

    // Limpiar filtros
    function clearFilters() {
      elements.colorFilter.value = '';
      elements.sizeFilter.value = '';
      elements.priceFilter.value = '';
      
      appState.filters = {
        color: '',
        size: '',
        maxPrice: ''
      };
      
      // Guardar filtros limpios en LocalStorage
      saveFiltersToLocalStorage();
      
      // Resetear a la primera página
      appState.currentPage = 1;
      
      // Aplicar filtros y renderizar
      const filteredProducts = filterProducts();
      renderProducts(filteredProducts);
    }

    // Create GitHub repository (simulate API call)
    async function createGithubRepository() {
      showLoading();
      
      try {
        // Simulate API call to GitHub
        await new Promise(resolve => setTimeout(resolve, 1500));
        
        // Update app state with mock repository data
        appState.githubRepo = {
          connected: true,
          url: 'https://github.com/mitienda/catalogo-ropa',
          name: 'catalogo-ropa'
        };
        
        // Update UI
        updateGithubStatus();
        
        showNotification('¡Éxito!', 'Repositorio GitHub creado correctamente.');
      } catch (error) {
        console.error('Error creating GitHub repository:', error);
        showNotification('Error', 'No se pudo crear el repositorio GitHub.', 'error');
      } finally {
        hideLoading();
      }
    }

    // Update GitHub status in UI
    function updateGithubStatus() {
      if (appState.githubRepo.connected) {
        elements.githubStatusText.textContent = `Repositorio: ${appState.githubRepo.name}`;
        elements.githubRepoLink.href = appState.githubRepo.url;
        elements.githubRepoLink.classList.remove('d-none');
        elements.createGithubRepoBtn.textContent = 'Repositorio Conectado';
        elements.createGithubRepoBtn.classList.replace('btn-success', 'btn-outline-success');
        elements.createGithubRepoBtn.disabled = true;
      } else {
        elements.githubStatusText.textContent = 'Estado del repositorio: No conectado';
        elements.githubRepoLink.classList.add('d-none');
      }
    }

    // Event Listeners
    document.addEventListener('DOMContentLoaded', () => {
      // Cargar filtros guardados
      loadFiltersFromLocalStorage();
      
      // Cargar productos
      loadProducts();
      
      // Event listener para crear producto
      elements.createProductBtn.addEventListener('click', openCreateProductModal);
      
      // Event listener para guardar producto
      elements.saveProductBtn.addEventListener('click', saveProduct);
      
      // Event listener para confirmar eliminación
      elements.confirmDeleteBtn.addEventListener('click', deleteProduct);
      
      // Event listeners para filtros
      elements.applyFiltersBtn.addEventListener('click', applyFilters);
      elements.clearFiltersBtn.addEventListener('click', clearFilters);
      
      // Validar que el precio sea mayor que 0
      const priceInput = document.getElementById('productPrice');
      priceInput.addEventListener('input', () => {
        if (parseFloat(priceInput.value) <= 0) {
          priceInput.setCustomValidity('El precio debe ser mayor que 0');
        } else {
          priceInput.setCustomValidity('');
        }
      });
      
      // GitHub repository creation
      elements.createGithubRepoBtn.addEventListener('click', createGithubRepository);
      
      // Initialize GitHub status
      updateGithubStatus();
    });
  </script>
</body>
</html>